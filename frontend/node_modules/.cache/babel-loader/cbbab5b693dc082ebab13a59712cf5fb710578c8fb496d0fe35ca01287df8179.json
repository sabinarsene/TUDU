{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\sabin.arsene\\\\Desktop\\\\TUDU-app\\\\TUDU\\\\frontend\\\\src\\\\components\\\\Chat\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useSocket } from '../../contexts/SocketContext';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { getMessages, sendMessage, markMessageRead, markConversationAsRead } from '../../services/messageApi';\nimport { getImageUrl } from '../../utils/imageUtils';\nimport './Chat.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = ({\n  otherUser\n}) => {\n  _s();\n  // Hooks and state\n  const {\n    userId\n  } = useParams();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket,\n    connected\n  } = useSocket();\n  const messagesEndRef = useRef(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isTyping, setIsTyping] = useState(false);\n  const [typingTimeout, setTypingTimeout] = useState(null);\n\n  // Message loading\n  useEffect(() => {\n    const loadMessages = async () => {\n      if (!userId) return;\n      try {\n        setLoading(true);\n        const data = await getMessages(userId);\n        setMessages(data);\n        setError(null);\n\n        // Mark all unread messages as read\n        try {\n          await markConversationAsRead(userId);\n        } catch (err) {\n          console.error('Error marking conversation as read:', err);\n        }\n      } catch (err) {\n        console.error('Error loading messages:', err);\n        setError('Failed to load messages');\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadMessages();\n  }, [userId]);\n\n  // Socket event handlers\n  useEffect(() => {\n    if (!socket || !connected || !(user !== null && user !== void 0 && user.id)) return;\n    const handleMessageReceived = message => {\n      if (message.sender_id === parseInt(userId) || message.receiver_id === parseInt(userId)) {\n        setMessages(prev => [...prev, {\n          ...message,\n          sender: message.sender_id === user.id ? 'you' : 'them'\n        }]);\n\n        // Mark message as read if we're the receiver\n        if (message.sender_id === parseInt(userId) && !message.read_at) {\n          markMessageRead(message.id).catch(console.error);\n        }\n      }\n    };\n    const handleMessageUpdated = message => {\n      if (message.sender_id === parseInt(userId) || message.receiver_id === parseInt(userId)) {\n        setMessages(prev => prev.map(m => m.id === message.id ? {\n          ...message,\n          sender: message.sender_id === user.id ? 'you' : 'them'\n        } : m));\n      }\n    };\n    const handleMessageDeleted = ({\n      messageId\n    }) => {\n      setMessages(prev => prev.filter(m => m.id !== messageId));\n    };\n    const handleUserTyping = ({\n      userId: typingUserId\n    }) => {\n      if (typingUserId === parseInt(userId)) {\n        setIsTyping(true);\n      }\n    };\n    const handleUserStoppedTyping = ({\n      userId: typingUserId\n    }) => {\n      if (typingUserId === parseInt(userId)) {\n        setIsTyping(false);\n      }\n    };\n\n    // Socket event listeners\n    socket.on('message_received', handleMessageReceived);\n    socket.on('message_updated', handleMessageUpdated);\n    socket.on('message_deleted', handleMessageDeleted);\n    socket.on('user_typing', handleUserTyping);\n    socket.on('user_stopped_typing', handleUserStoppedTyping);\n\n    // Cleanup\n    return () => {\n      socket.off('message_received', handleMessageReceived);\n      socket.off('message_updated', handleMessageUpdated);\n      socket.off('message_deleted', handleMessageDeleted);\n      socket.off('user_typing', handleUserTyping);\n      socket.off('user_stopped_typing', handleUserStoppedTyping);\n    };\n  }, [socket, connected, userId, user === null || user === void 0 ? void 0 : user.id]);\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n\n  // Handle typing indicator\n  const handleTyping = () => {\n    if (!socket || !connected) return;\n\n    // Emit typing event\n    socket.emit('typing', userId);\n\n    // Reset existing timeout\n    if (typingTimeout) clearTimeout(typingTimeout);\n\n    // Set a new timeout to stop typing indicator\n    const timeout = setTimeout(() => {\n      socket.emit('stop_typing', userId);\n    }, 3000);\n    setTypingTimeout(timeout);\n  };\n\n  // Message handlers\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    const messageText = newMessage.trim();\n    if (!messageText) return;\n    try {\n      // Stop typing indicator\n      if (socket && connected) {\n        socket.emit('stop_typing', userId);\n      }\n      const sentMessage = await sendMessage(userId, messageText);\n      setNewMessage('');\n\n      // Add sent message to local state\n      setMessages(prev => [...prev, {\n        id: sentMessage.id,\n        text: sentMessage.content,\n        time: sentMessage.created_at,\n        sender: 'you',\n        isRead: false,\n        isEdited: false\n      }]);\n    } catch (err) {\n      console.error('Error sending message:', err);\n      setError('Failed to send message');\n    }\n  };\n\n  // Group messages by date\n  const groupMessagesByDate = messages => {\n    const groups = {};\n    messages.forEach(message => {\n      const date = new Date(message.time).toLocaleDateString();\n      if (!groups[date]) {\n        groups[date] = [];\n      }\n      groups[date].push(message);\n    });\n    return Object.entries(groups).map(([date, messages]) => ({\n      date,\n      messages\n    }));\n  };\n\n  // Render loading state\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-full bg-gray-50\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"ml-2 text-gray-600\",\n        children: \"Loading messages...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Render error state\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-full bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-red-500 font-medium\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this);\n  }\n  const groupedMessages = groupMessagesByDate(messages);\n\n  // Main render\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-full bg-gray-50 rounded-lg shadow-sm overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between px-4 py-3 bg-white border-b\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: getImageUrl(otherUser === null || otherUser === void 0 ? void 0 : otherUser.image) || \"/placeholder.svg\",\n            alt: otherUser === null || otherUser === void 0 ? void 0 : otherUser.name,\n            className: \"w-10 h-10 rounded-full object-cover\",\n            onError: e => {\n              e.target.onerror = null;\n              e.target.src = \"/default-avatar.png\";\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this), (otherUser === null || otherUser === void 0 ? void 0 : otherUser.isOnline) && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-medium text-gray-900\",\n            children: otherUser === null || otherUser === void 0 ? void 0 : otherUser.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500\",\n            children: otherUser !== null && otherUser !== void 0 && otherUser.isOnline ? \"Online\" : \"Offline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"p-2 rounded-full hover:bg-gray-100 text-gray-600\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"18\",\n            height: \"18\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"p-2 rounded-full hover:bg-gray-100 text-gray-600\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"18\",\n            height: \"18\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: [/*#__PURE__*/_jsxDEV(\"polygon\", {\n              points: \"23 7 16 12 23 17 23 7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n              x: \"1\",\n              y: \"5\",\n              width: \"15\",\n              height: \"14\",\n              rx: \"2\",\n              ry: \"2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"p-2 rounded-full hover:bg-gray-100 text-gray-600\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"18\",\n            height: \"18\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"12\",\n              cy: \"12\",\n              r: \"1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"12\",\n              cy: \"5\",\n              r: \"1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"12\",\n              cy: \"19\",\n              r: \"1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 p-4 overflow-y-auto bg-gray-50\",\n      children: [groupedMessages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-16 h-16 mb-4 rounded-full bg-gray-100 flex items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"24\",\n            height: \"24\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            className: \"text-gray-400\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 mb-2\",\n          children: \"No messages yet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 max-w-xs text-center\",\n          children: \"Send a message to start the conversation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }, this) : groupedMessages.map(group => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center mb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"px-3 py-1 text-xs font-medium bg-gray-200 rounded-full text-gray-600\",\n            children: formatDate(group.date)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 15\n        }, this), group.messages.map((message, index) => {\n          const isFirstInGroup = index === 0 || group.messages[index - 1].sender !== message.sender;\n          const isLastInGroup = index === group.messages.length - 1 || group.messages[index + 1].sender !== message.sender;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex ${message.sender === \"you\" ? \"justify-end\" : \"justify-start\"} mb-1`,\n            children: [message.sender === \"them\" && isLastInGroup && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-shrink-0 mr-2 self-end\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: getImageUrl(otherUser === null || otherUser === void 0 ? void 0 : otherUser.image) || \"/placeholder.svg\",\n                alt: otherUser === null || otherUser === void 0 ? void 0 : otherUser.name,\n                className: \"w-8 h-8 rounded-full object-cover\",\n                onError: e => {\n                  e.target.onerror = null;\n                  e.target.src = \"/default-avatar.png\";\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 23\n            }, this), message.sender === \"them\" && !isLastInGroup && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 69\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `max-w-[75%] px-4 py-2 ${message.sender === \"you\" ? \"bg-blue-500 text-white rounded-t-2xl rounded-bl-2xl\" : \"bg-white text-gray-800 rounded-t-2xl rounded-br-2xl border border-gray-200\"} ${!isFirstInGroup && message.sender === \"you\" ? \"rounded-tr-md\" : \"\"} ${!isFirstInGroup && message.sender === \"them\" ? \"rounded-tl-md\" : \"\"} ${!isLastInGroup && message.sender === \"you\" ? \"rounded-br-md\" : \"\"} ${!isLastInGroup && message.sender === \"them\" ? \"rounded-bl-md\" : \"\"}`,\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm whitespace-pre-wrap break-words\",\n                children: message.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `flex items-center justify-end mt-1 space-x-1 ${message.sender === \"you\" ? \"text-blue-100\" : \"text-gray-400\"}`,\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs\",\n                  children: new Date(message.time).toLocaleTimeString([], {\n                    hour: \"2-digit\",\n                    minute: \"2-digit\"\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 25\n                }, this), message.isEdited && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs italic\",\n                  children: \"(edited)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 365,\n                  columnNumber: 46\n                }, this), message.sender === \"you\" && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs\",\n                  children: message.isRead ? \"✓✓\" : \"✓\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 21\n            }, this), message.sender === \"you\" && isLastInGroup && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-shrink-0 ml-2 self-end\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: getImageUrl(user === null || user === void 0 ? void 0 : user.image) || \"/placeholder.svg\",\n                alt: user === null || user === void 0 ? void 0 : user.name,\n                className: \"w-8 h-8 rounded-full object-cover\",\n                onError: e => {\n                  e.target.onerror = null;\n                  e.target.src = \"/default-avatar.png\";\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 23\n            }, this), message.sender === \"you\" && !isLastInGroup && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 ml-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 68\n            }, this)]\n          }, message.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 19\n          }, this);\n        })]\n      }, group.date, true, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 13\n      }, this)), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex mb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-10 bg-gray-200 px-4 py-2 rounded-2xl flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSendMessage,\n      className: \"p-3 bg-white border-t flex items-center space-x-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"p-2 rounded-full hover:bg-gray-100 text-gray-600\",\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"20\",\n          height: \"20\",\n          viewBox: \"0 0 24 24\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n            x: \"3\",\n            y: \"3\",\n            width: \"18\",\n            height: \"18\",\n            rx: \"2\",\n            ry: \"2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n            cx: \"8.5\",\n            cy: \"8.5\",\n            r: \"1.5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n            points: \"21 15 16 10 5 21\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: newMessage,\n        onChange: e => setNewMessage(e.target.value),\n        onKeyDown: handleTyping,\n        placeholder: \"Type a message...\",\n        className: \"flex-1 py-2 px-4 bg-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: `p-2 rounded-full ${newMessage.trim() ? \"bg-blue-500 text-white hover:bg-blue-600\" : \"bg-gray-200 text-gray-400 cursor-not-allowed\"}`,\n        disabled: !newMessage.trim(),\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"20\",\n          height: \"20\",\n          viewBox: \"0 0 24 24\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: \"22\",\n            y1: \"2\",\n            x2: \"11\",\n            y2: \"13\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"polygon\", {\n            points: \"22 2 15 22 11 13 2 9 22 2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n};\n\n// Helper function to format date\n_s(Chat, \"Ue8hxdPiVXsKx7B5PpB52zDyPno=\", false, function () {\n  return [useParams, useAuth, useSocket];\n});\n_c = Chat;\nfunction formatDate(dateString) {\n  const date = new Date(dateString);\n  const today = new Date();\n  const yesterday = new Date(today);\n  yesterday.setDate(yesterday.getDate() - 1);\n  if (date.toDateString() === today.toDateString()) {\n    return \"Today\";\n  } else if (date.toDateString() === yesterday.toDateString()) {\n    return \"Yesterday\";\n  } else {\n    return date.toLocaleDateString(undefined, {\n      weekday: \"long\",\n      month: \"short\",\n      day: \"numeric\"\n    });\n  }\n}\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","React","useState","useEffect","useRef","useParams","useSocket","useAuth","getMessages","sendMessage","markMessageRead","markConversationAsRead","getImageUrl","jsxDEV","_jsxDEV","Chat","otherUser","userId","user","socket","connected","messagesEndRef","messages","setMessages","newMessage","setNewMessage","loading","setLoading","error","setError","isTyping","setIsTyping","typingTimeout","setTypingTimeout","loadMessages","data","err","console","id","handleMessageReceived","message","sender_id","parseInt","receiver_id","prev","sender","read_at","catch","handleMessageUpdated","map","m","handleMessageDeleted","messageId","filter","handleUserTyping","typingUserId","handleUserStoppedTyping","on","off","_messagesEndRef$curre","current","scrollIntoView","behavior","handleTyping","emit","clearTimeout","timeout","setTimeout","handleSendMessage","e","preventDefault","messageText","trim","sentMessage","text","content","time","created_at","isRead","isEdited","groupMessagesByDate","groups","forEach","date","Date","toLocaleDateString","push","Object","entries","className","children","fileName","lineNumber","columnNumber","groupedMessages","src","image","alt","name","onError","target","onerror","isOnline","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","points","x","y","rx","ry","cx","cy","r","length","group","formatDate","index","isFirstInGroup","isLastInGroup","toLocaleTimeString","hour","minute","ref","onSubmit","type","value","onChange","onKeyDown","placeholder","disabled","x1","y1","x2","y2","_c","dateString","today","yesterday","setDate","getDate","toDateString","undefined","weekday","month","day","$RefreshReg$"],"sources":["C:/Users/sabin.arsene/Desktop/TUDU-app/TUDU/frontend/src/components/Chat/Chat.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useSocket } from '../../contexts/SocketContext';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { getMessages, sendMessage, markMessageRead, markConversationAsRead } from '../../services/messageApi';\r\nimport { getImageUrl } from '../../utils/imageUtils';\r\nimport './Chat.css';\r\n\r\nconst Chat = ({ otherUser }) => {\r\n  // Hooks and state\r\n  const { userId } = useParams();\r\n  const { user } = useAuth();\r\n  const { socket, connected } = useSocket();\r\n  const messagesEndRef = useRef(null);\r\n  \r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [typingTimeout, setTypingTimeout] = useState(null);\r\n\r\n  // Message loading\r\n  useEffect(() => {\r\n    const loadMessages = async () => {\r\n      if (!userId) return;\r\n      \r\n      try {\r\n        setLoading(true);\r\n        const data = await getMessages(userId);\r\n        setMessages(data);\r\n        setError(null);\r\n        \r\n        // Mark all unread messages as read\r\n        try {\r\n          await markConversationAsRead(userId);\r\n        } catch (err) {\r\n          console.error('Error marking conversation as read:', err);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error loading messages:', err);\r\n        setError('Failed to load messages');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadMessages();\r\n  }, [userId]);\r\n\r\n  // Socket event handlers\r\n  useEffect(() => {\r\n    if (!socket || !connected || !user?.id) return;\r\n\r\n    const handleMessageReceived = (message) => {\r\n      if (message.sender_id === parseInt(userId) || message.receiver_id === parseInt(userId)) {\r\n        setMessages(prev => [...prev, {\r\n          ...message,\r\n          sender: message.sender_id === user.id ? 'you' : 'them'\r\n        }]);\r\n        \r\n        // Mark message as read if we're the receiver\r\n        if (message.sender_id === parseInt(userId) && !message.read_at) {\r\n          markMessageRead(message.id).catch(console.error);\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleMessageUpdated = (message) => {\r\n      if (message.sender_id === parseInt(userId) || message.receiver_id === parseInt(userId)) {\r\n        setMessages(prev => prev.map(m => \r\n          m.id === message.id ? {\r\n            ...message,\r\n            sender: message.sender_id === user.id ? 'you' : 'them'\r\n          } : m\r\n        ));\r\n      }\r\n    };\r\n\r\n    const handleMessageDeleted = ({ messageId }) => {\r\n      setMessages(prev => prev.filter(m => m.id !== messageId));\r\n    };\r\n\r\n    const handleUserTyping = ({ userId: typingUserId }) => {\r\n      if (typingUserId === parseInt(userId)) {\r\n        setIsTyping(true);\r\n      }\r\n    };\r\n\r\n    const handleUserStoppedTyping = ({ userId: typingUserId }) => {\r\n      if (typingUserId === parseInt(userId)) {\r\n        setIsTyping(false);\r\n      }\r\n    };\r\n\r\n    // Socket event listeners\r\n    socket.on('message_received', handleMessageReceived);\r\n    socket.on('message_updated', handleMessageUpdated);\r\n    socket.on('message_deleted', handleMessageDeleted);\r\n    socket.on('user_typing', handleUserTyping);\r\n    socket.on('user_stopped_typing', handleUserStoppedTyping);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      socket.off('message_received', handleMessageReceived);\r\n      socket.off('message_updated', handleMessageUpdated);\r\n      socket.off('message_deleted', handleMessageDeleted);\r\n      socket.off('user_typing', handleUserTyping);\r\n      socket.off('user_stopped_typing', handleUserStoppedTyping);\r\n    };\r\n  }, [socket, connected, userId, user?.id]);\r\n\r\n  // Auto-scroll to bottom when messages change\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  // Handle typing indicator\r\n  const handleTyping = () => {\r\n    if (!socket || !connected) return;\r\n    \r\n    // Emit typing event\r\n    socket.emit('typing', userId);\r\n    \r\n    // Reset existing timeout\r\n    if (typingTimeout) clearTimeout(typingTimeout);\r\n    \r\n    // Set a new timeout to stop typing indicator\r\n    const timeout = setTimeout(() => {\r\n      socket.emit('stop_typing', userId);\r\n    }, 3000);\r\n    \r\n    setTypingTimeout(timeout);\r\n  };\r\n\r\n  // Message handlers\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    const messageText = newMessage.trim();\r\n    \r\n    if (!messageText) return;\r\n\r\n    try {\r\n      // Stop typing indicator\r\n      if (socket && connected) {\r\n        socket.emit('stop_typing', userId);\r\n      }\r\n      \r\n      const sentMessage = await sendMessage(userId, messageText);\r\n      setNewMessage('');\r\n      \r\n      // Add sent message to local state\r\n      setMessages(prev => [...prev, {\r\n        id: sentMessage.id,\r\n        text: sentMessage.content,\r\n        time: sentMessage.created_at,\r\n        sender: 'you',\r\n        isRead: false,\r\n        isEdited: false\r\n      }]);\r\n    } catch (err) {\r\n      console.error('Error sending message:', err);\r\n      setError('Failed to send message');\r\n    }\r\n  };\r\n\r\n  // Group messages by date\r\n  const groupMessagesByDate = (messages) => {\r\n    const groups = {};\r\n\r\n    messages.forEach((message) => {\r\n      const date = new Date(message.time).toLocaleDateString();\r\n      if (!groups[date]) {\r\n        groups[date] = [];\r\n      }\r\n      groups[date].push(message);\r\n    });\r\n\r\n    return Object.entries(groups).map(([date, messages]) => ({\r\n      date,\r\n      messages,\r\n    }));\r\n  };\r\n\r\n  // Render loading state\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full bg-gray-50\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"></div>\r\n        <span className=\"ml-2 text-gray-600\">Loading messages...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Render error state\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full bg-gray-50\">\r\n        <div className=\"text-red-500 font-medium\">{error}</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const groupedMessages = groupMessagesByDate(messages);\r\n\r\n  // Main render\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-gray-50 rounded-lg shadow-sm overflow-hidden\">\r\n      {/* Chat header */}\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-white border-b\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"relative\">\r\n            <img\r\n              src={getImageUrl(otherUser?.image) || \"/placeholder.svg\"}\r\n              alt={otherUser?.name}\r\n              className=\"w-10 h-10 rounded-full object-cover\"\r\n              onError={(e) => {\r\n                e.target.onerror = null;\r\n                e.target.src = \"/default-avatar.png\";\r\n              }}\r\n            />\r\n            {otherUser?.isOnline && (\r\n              <span className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white\"></span>\r\n            )}\r\n          </div>\r\n          <div>\r\n            <h3 className=\"font-medium text-gray-900\">{otherUser?.name}</h3>\r\n            <p className=\"text-xs text-gray-500\">{otherUser?.isOnline ? \"Online\" : \"Offline\"}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <button className=\"p-2 rounded-full hover:bg-gray-100 text-gray-600\">\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              width=\"18\"\r\n              height=\"18\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            >\r\n              <path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"></path>\r\n            </svg>\r\n          </button>\r\n          <button className=\"p-2 rounded-full hover:bg-gray-100 text-gray-600\">\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              width=\"18\"\r\n              height=\"18\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            >\r\n              <polygon points=\"23 7 16 12 23 17 23 7\"></polygon>\r\n              <rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\"></rect>\r\n            </svg>\r\n          </button>\r\n          <button className=\"p-2 rounded-full hover:bg-gray-100 text-gray-600\">\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              width=\"18\"\r\n              height=\"18\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            >\r\n              <circle cx=\"12\" cy=\"12\" r=\"1\"></circle>\r\n              <circle cx=\"12\" cy=\"5\" r=\"1\"></circle>\r\n              <circle cx=\"12\" cy=\"19\" r=\"1\"></circle>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Messages container */}\r\n      <div className=\"flex-1 p-4 overflow-y-auto bg-gray-50\">\r\n        {groupedMessages.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center h-full\">\r\n            <div className=\"w-16 h-16 mb-4 rounded-full bg-gray-100 flex items-center justify-center\">\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"24\"\r\n                height=\"24\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                strokeWidth=\"2\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                className=\"text-gray-400\"\r\n              >\r\n                <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"></path>\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No messages yet</h3>\r\n            <p className=\"text-sm text-gray-500 max-w-xs text-center\">\r\n              Send a message to start the conversation\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          groupedMessages.map((group) => (\r\n            <div key={group.date} className=\"mb-4\">\r\n              <div className=\"flex justify-center mb-4\">\r\n                <span className=\"px-3 py-1 text-xs font-medium bg-gray-200 rounded-full text-gray-600\">\r\n                  {formatDate(group.date)}\r\n                </span>\r\n              </div>\r\n\r\n              {group.messages.map((message, index) => {\r\n                const isFirstInGroup = index === 0 || group.messages[index - 1].sender !== message.sender;\r\n                const isLastInGroup =\r\n                  index === group.messages.length - 1 || group.messages[index + 1].sender !== message.sender;\r\n\r\n                return (\r\n                  <div\r\n                    key={message.id}\r\n                    className={`flex ${message.sender === \"you\" ? \"justify-end\" : \"justify-start\"} mb-1`}\r\n                  >\r\n                    {message.sender === \"them\" && isLastInGroup && (\r\n                      <div className=\"flex-shrink-0 mr-2 self-end\">\r\n                        <img\r\n                          src={getImageUrl(otherUser?.image) || \"/placeholder.svg\"}\r\n                          alt={otherUser?.name}\r\n                          className=\"w-8 h-8 rounded-full object-cover\"\r\n                          onError={(e) => {\r\n                            e.target.onerror = null;\r\n                            e.target.src = \"/default-avatar.png\";\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    )}\r\n\r\n                    {message.sender === \"them\" && !isLastInGroup && <div className=\"w-8 mr-2\"></div>}\r\n\r\n                    <div\r\n                      className={`max-w-[75%] px-4 py-2 ${\r\n                        message.sender === \"you\"\r\n                          ? \"bg-blue-500 text-white rounded-t-2xl rounded-bl-2xl\"\r\n                          : \"bg-white text-gray-800 rounded-t-2xl rounded-br-2xl border border-gray-200\"\r\n                      } ${!isFirstInGroup && message.sender === \"you\" ? \"rounded-tr-md\" : \"\"} ${\r\n                        !isFirstInGroup && message.sender === \"them\" ? \"rounded-tl-md\" : \"\"\r\n                      } ${!isLastInGroup && message.sender === \"you\" ? \"rounded-br-md\" : \"\"} ${\r\n                        !isLastInGroup && message.sender === \"them\" ? \"rounded-bl-md\" : \"\"\r\n                      }`}\r\n                    >\r\n                      <p className=\"text-sm whitespace-pre-wrap break-words\">{message.text}</p>\r\n                      <div\r\n                        className={`flex items-center justify-end mt-1 space-x-1 ${\r\n                          message.sender === \"you\" ? \"text-blue-100\" : \"text-gray-400\"\r\n                        }`}\r\n                      >\r\n                        <span className=\"text-xs\">\r\n                          {new Date(message.time).toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })}\r\n                        </span>\r\n                        {message.isEdited && <span className=\"text-xs italic\">(edited)</span>}\r\n                        {message.sender === \"you\" && (\r\n                          <span className=\"text-xs\">\r\n                            {message.isRead ? \"✓✓\" : \"✓\"}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    {message.sender === \"you\" && isLastInGroup && (\r\n                      <div className=\"flex-shrink-0 ml-2 self-end\">\r\n                        <img\r\n                          src={getImageUrl(user?.image) || \"/placeholder.svg\"}\r\n                          alt={user?.name}\r\n                          className=\"w-8 h-8 rounded-full object-cover\"\r\n                          onError={(e) => {\r\n                            e.target.onerror = null;\r\n                            e.target.src = \"/default-avatar.png\";\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    )}\r\n\r\n                    {message.sender === \"you\" && !isLastInGroup && <div className=\"w-8 ml-2\"></div>}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          ))\r\n        )}\r\n\r\n        {isTyping && (\r\n          <div className=\"flex mb-4\">\r\n            <div className=\"ml-10 bg-gray-200 px-4 py-2 rounded-2xl flex items-center\">\r\n              <span className=\"typing-dot\"></span>\r\n              <span className=\"typing-dot\"></span>\r\n              <span className=\"typing-dot\"></span>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Message input */}\r\n      <form onSubmit={handleSendMessage} className=\"p-3 bg-white border-t flex items-center space-x-2\">\r\n        <button type=\"button\" className=\"p-2 rounded-full hover:bg-gray-100 text-gray-600\">\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width=\"20\"\r\n            height=\"20\"\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            strokeWidth=\"2\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n          >\r\n            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\r\n            <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"></circle>\r\n            <polyline points=\"21 15 16 10 5 21\"></polyline>\r\n          </svg>\r\n        </button>\r\n        <input\r\n          type=\"text\"\r\n          value={newMessage}\r\n          onChange={(e) => setNewMessage(e.target.value)}\r\n          onKeyDown={handleTyping}\r\n          placeholder=\"Type a message...\"\r\n          className=\"flex-1 py-2 px-4 bg-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white\"\r\n        />\r\n        <button\r\n          type=\"submit\"\r\n          className={`p-2 rounded-full ${\r\n            newMessage.trim()\r\n              ? \"bg-blue-500 text-white hover:bg-blue-600\"\r\n              : \"bg-gray-200 text-gray-400 cursor-not-allowed\"\r\n          }`}\r\n          disabled={!newMessage.trim()}\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width=\"20\"\r\n            height=\"20\"\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            strokeWidth=\"2\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n          >\r\n            <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\"></line>\r\n            <polygon points=\"22 2 15 22 11 13 2 9 22 2\"></polygon>\r\n          </svg>\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Helper function to format date\r\nfunction formatDate(dateString) {\r\n  const date = new Date(dateString);\r\n  const today = new Date();\r\n  const yesterday = new Date(today);\r\n  yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n  if (date.toDateString() === today.toDateString()) {\r\n    return \"Today\";\r\n  } else if (date.toDateString() === yesterday.toDateString()) {\r\n    return \"Yesterday\";\r\n  } else {\r\n    return date.toLocaleDateString(undefined, {\r\n      weekday: \"long\",\r\n      month: \"short\",\r\n      day: \"numeric\",\r\n    });\r\n  }\r\n}\r\n\r\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}