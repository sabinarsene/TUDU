{"ast":null,"code":"import { FOCUS_DISABLED, FOCUS_GROUP } from '../constants';\nimport { asArray, toArray } from './array';\n/**\r\n * in case of multiple nodes nested inside each other\r\n * keeps only top ones\r\n * this is O(nlogn)\r\n * @param nodes\r\n * @returns {*}\r\n */\nvar filterNested = function (nodes) {\n  var contained = new Set();\n  var l = nodes.length;\n  for (var i = 0; i < l; i += 1) {\n    for (var j = i + 1; j < l; j += 1) {\n      var position = nodes[i].compareDocumentPosition(nodes[j]);\n      /* eslint-disable no-bitwise */\n      if ((position & Node.DOCUMENT_POSITION_CONTAINED_BY) > 0) {\n        contained.add(j);\n      }\n      if ((position & Node.DOCUMENT_POSITION_CONTAINS) > 0) {\n        contained.add(i);\n      }\n      /* eslint-enable */\n    }\n  }\n  return nodes.filter(function (_, index) {\n    return !contained.has(index);\n  });\n};\n/**\r\n * finds top most parent for a node\r\n * @param node\r\n * @returns {*}\r\n */\nvar getTopParent = function (node) {\n  return node.parentNode ? getTopParent(node.parentNode) : node;\n};\n/**\r\n * returns all \"focus containers\" inside a given node\r\n * @param node - node or nodes to look inside\r\n * @returns Element[]\r\n */\nexport var getAllAffectedNodes = function (node) {\n  var nodes = asArray(node);\n  return nodes.filter(Boolean).reduce(function (acc, currentNode) {\n    var group = currentNode.getAttribute(FOCUS_GROUP);\n    acc.push.apply(acc, group ? filterNested(toArray(getTopParent(currentNode).querySelectorAll(\"[\".concat(FOCUS_GROUP, \"=\\\"\").concat(group, \"\\\"]:not([\").concat(FOCUS_DISABLED, \"=\\\"disabled\\\"])\")))) : [currentNode]);\n    return acc;\n  }, []);\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}