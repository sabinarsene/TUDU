{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sabin.arsene\\\\Desktop\\\\Tudu-app\\\\TUDU\\\\frontend\\\\src\\\\components\\\\Chat\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Box, VStack, Input, Button, Text, Flex, HStack, IconButton, Badge, Popover, PopoverTrigger, PopoverContent, Tooltip, Spinner } from '@chakra-ui/react';\nimport { useSocket } from '../../contexts/SocketContext';\nimport axios from 'axios';\n\n// Corrected icon imports\nimport { Smile, CornerUpLeft } from 'react-feather';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function Chat({\n  receiverId,\n  receiverName\n}) {\n  _s();\n  const {\n    socket\n  } = useSocket();\n  const [messages, setMessages] = useState([]);\n  const [receiverStatus, setReceiverStatus] = useState('offline');\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [isWindowFocused, setIsWindowFocused] = useState(true);\n  const [newMessage, setNewMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [replyTo, setReplyTo] = useState(null);\n  const messagesEndRef = useRef(null);\n  const typingTimeoutRef = useRef(null);\n  const loadMessages = async () => {\n    try {\n      const response = await axios.get(`${process.env.REACT_APP_API_URL}/messages/${receiverId}`);\n      setMessages(response.data);\n      setLoading(false);\n    } catch (error) {\n      console.error('Error loading messages:', error);\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    const handleFocus = () => setIsWindowFocused(true);\n    const handleBlur = () => setIsWindowFocused(false);\n    window.addEventListener('focus', handleFocus);\n    window.addEventListener('blur', handleBlur);\n\n    // If you have a NotificationService, uncomment this\n    // NotificationService.requestPermission();\n\n    return () => {\n      window.removeEventListener('focus', handleFocus);\n      window.removeEventListener('blur', handleBlur);\n    };\n  }, []);\n  useEffect(() => {\n    loadMessages();\n  }, [receiverId, loadMessages]);\n  useEffect(() => {\n    if (socket) {\n      socket.on('user_status', data => {\n        if (data.userId === receiverId) {\n          setReceiverStatus(data.status);\n        }\n      });\n\n      // Request receiver's status\n      socket.emit('get_user_status', receiverId);\n      return () => {\n        socket.off('user_status');\n      };\n    }\n  }, [socket, receiverId]);\n\n  // Scroll to bottom when messages change\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n  useEffect(() => {\n    if (socket) {\n      socket.emit('join_chat', receiverId);\n      socket.on('receive_message', data => {\n        setMessages(prev => [...prev, data]);\n        if (!isWindowFocused) {\n          setUnreadCount(prev => prev + 1);\n          // If you have a NotificationService, uncomment this\n          // NotificationService.showNotification(`New message from ${receiverName}`, {\n          //   body: data.content,\n          //   tag: 'chat-message'\n          // }, {\n          //   once: true\n          // });\n        }\n      });\n      socket.on('user_typing', userId => {\n        if (userId === receiverId) {\n          setIsTyping(true);\n          setTimeout(() => setIsTyping(false), 3000);\n        }\n      });\n      return () => {\n        socket.off('receive_message');\n        socket.off('user_typing');\n        socket.emit('leave_chat', receiverId);\n      };\n    }\n  }, [socket, receiverId, isWindowFocused, receiverName]);\n  useEffect(() => {\n    if (isWindowFocused && unreadCount > 0) {\n      setUnreadCount(0);\n      // Mark messages as read\n      messages.filter(msg => !msg.read_at && msg.sender_id === receiverId).forEach(msg => {\n        if (socket) {\n          socket.emit('message_read', {\n            messageId: msg.id,\n            userId: localStorage.getItem('userId'),\n            senderId: msg.sender_id\n          });\n        }\n      });\n    }\n  }, [isWindowFocused, messages, unreadCount, receiverId, socket]);\n  const handleTyping = () => {\n    if (socket) {\n      socket.emit('typing', receiverId);\n    }\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n    typingTimeoutRef.current = setTimeout(() => {\n      if (socket) {\n        socket.emit('stop_typing', receiverId);\n      }\n    }, 2000);\n  };\n  const handleSend = async () => {\n    if (!newMessage.trim()) return;\n    try {\n      const messageData = {\n        content: newMessage,\n        receiverId,\n        replyTo: replyTo === null || replyTo === void 0 ? void 0 : replyTo.id\n      };\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/messages`, messageData);\n      if (socket) {\n        socket.emit('send_message', {\n          ...response.data,\n          receiverId\n        });\n      }\n      setMessages(prev => [...prev, response.data]);\n      setNewMessage('');\n      setReplyTo(null);\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const reactions = ['ðŸ‘', 'â¤ï¸', 'ðŸ˜Š', 'ðŸ˜‚', 'ðŸ˜®', 'ðŸ˜¢'];\n  const handleReaction = async (messageId, reaction) => {\n    try {\n      await axios.post(`${process.env.REACT_APP_API_URL}/messages/${messageId}/reactions`, {\n        reaction\n      });\n      if (socket) {\n        socket.emit('message_reaction', {\n          messageId,\n          reaction,\n          receiverId\n        });\n      }\n    } catch (error) {\n      console.error('Error adding reaction:', error);\n    }\n  };\n  const handleReply = message => {\n    setReplyTo(message);\n    // Focus on input\n    document.querySelector('#messageInput').focus();\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      h: \"100%\",\n      children: /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this);\n  }\n  const MessageBubble = ({\n    message\n  }) => {\n    var _messages$find, _message$reactions;\n    return /*#__PURE__*/_jsxDEV(Box, {\n      position: \"relative\",\n      maxW: \"70%\",\n      children: [message.reply_to && /*#__PURE__*/_jsxDEV(Box, {\n        borderLeftWidth: \"2px\",\n        borderLeftColor: \"gray.300\",\n        pl: 2,\n        mb: 1,\n        opacity: 0.7,\n        children: /*#__PURE__*/_jsxDEV(Text, {\n          fontSize: \"sm\",\n          children: (_messages$find = messages.find(m => m.id === message.reply_to)) === null || _messages$find === void 0 ? void 0 : _messages$find.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        bg: message.sender_id === parseInt(localStorage.getItem('userId')) ? 'blue.500' : 'gray.200',\n        color: message.sender_id === parseInt(localStorage.getItem('userId')) ? 'white' : 'black',\n        borderRadius: \"lg\",\n        px: 3,\n        py: 2,\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          children: message.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 9\n        }, this), ((_message$reactions = message.reactions) === null || _message$reactions === void 0 ? void 0 : _message$reactions.length) > 0 && /*#__PURE__*/_jsxDEV(HStack, {\n          spacing: 1,\n          mt: 1,\n          children: Object.entries(message.reactions.reduce((acc, r) => ({\n            ...acc,\n            [r.reaction]: (acc[r.reaction] || 0) + 1\n          }), {})).map(([reaction, count]) => /*#__PURE__*/_jsxDEV(Badge, {\n            variant: \"subtle\",\n            colorScheme: \"gray\",\n            children: [reaction, \" \", count]\n          }, reaction, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(HStack, {\n        position: \"absolute\",\n        right: 2,\n        bottom: -6,\n        opacity: 0,\n        _groupHover: {\n          opacity: 1\n        },\n        transition: \"0.2s\",\n        children: [/*#__PURE__*/_jsxDEV(Popover, {\n          placement: \"top\",\n          children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              size: \"xs\",\n              icon: /*#__PURE__*/_jsxDEV(Smile, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 41\n              }, this),\n              variant: \"ghost\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n            w: \"auto\",\n            p: 2,\n            children: /*#__PURE__*/_jsxDEV(HStack, {\n              children: reactions.map(reaction => /*#__PURE__*/_jsxDEV(Box, {\n                cursor: \"pointer\",\n                p: 1,\n                _hover: {\n                  bg: 'gray.100'\n                },\n                onClick: () => handleReaction(message.id, reaction),\n                children: reaction\n              }, reaction, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n          label: \"Reply\",\n          children: /*#__PURE__*/_jsxDEV(IconButton, {\n            size: \"xs\",\n            icon: /*#__PURE__*/_jsxDEV(CornerUpLeft, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 19\n            }, this),\n            variant: \"ghost\",\n            onClick: () => handleReply(message)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 5\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    h: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      p: 4,\n      bg: \"gray.100\",\n      borderBottom: \"1px\",\n      borderColor: \"gray.200\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        justify: \"space-between\",\n        align: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          fontWeight: \"bold\",\n          children: receiverName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Badge, {\n          colorScheme: receiverStatus === 'online' ? 'green' : 'gray',\n          children: receiverStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(VStack, {\n      flex: 1,\n      p: 4,\n      spacing: 4,\n      overflowY: \"auto\",\n      children: [messages.map(message => /*#__PURE__*/_jsxDEV(MessageBubble, {\n        message: message\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 11\n      }, this)), isTyping && /*#__PURE__*/_jsxDEV(Text, {\n        color: \"gray.500\",\n        fontSize: \"sm\",\n        alignSelf: \"flex-start\",\n        children: [receiverName, \" is typing...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }, this), replyTo && /*#__PURE__*/_jsxDEV(Box, {\n      p: 2,\n      bg: \"gray.50\",\n      borderTop: \"1px\",\n      borderColor: \"gray.200\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        justify: \"space-between\",\n        align: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          fontSize: \"sm\",\n          color: \"gray.600\",\n          children: [\"Replying to: \", replyTo.content]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n          icon: /*#__PURE__*/_jsxDEV(CornerUpLeft, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 21\n          }, this),\n          size: \"sm\",\n          variant: \"ghost\",\n          onClick: () => setReplyTo(null)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      p: 4,\n      borderTop: \"1px\",\n      borderColor: \"gray.200\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          id: \"messageInput\",\n          value: newMessage,\n          onChange: e => {\n            setNewMessage(e.target.value);\n            handleTyping();\n          },\n          placeholder: \"Type a message...\",\n          mr: 2\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Popover, {\n          children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              icon: /*#__PURE__*/_jsxDEV(Smile, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 33\n              }, this),\n              variant: \"ghost\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n            p: 2,\n            children: /*#__PURE__*/_jsxDEV(Flex, {\n              wrap: \"wrap\",\n              gap: 2,\n              children: reactions.map(reaction => /*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"ghost\",\n                onClick: () => {\n                  setNewMessage(prev => prev + reaction);\n                  document.querySelector('#messageInput').focus();\n                },\n                children: reaction\n              }, reaction, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          ml: 2,\n          colorScheme: \"blue\",\n          onClick: handleSend,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 274,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"DRA0/mTnHDxtNQB661qXz1upBjo=\", false, function () {\n  return [useSocket];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Box","VStack","Input","Button","Text","Flex","HStack","IconButton","Badge","Popover","PopoverTrigger","PopoverContent","Tooltip","Spinner","useSocket","axios","Smile","CornerUpLeft","jsxDEV","_jsxDEV","Chat","receiverId","receiverName","_s","socket","messages","setMessages","receiverStatus","setReceiverStatus","unreadCount","setUnreadCount","isWindowFocused","setIsWindowFocused","newMessage","setNewMessage","isTyping","setIsTyping","loading","setLoading","replyTo","setReplyTo","messagesEndRef","typingTimeoutRef","loadMessages","response","get","process","env","REACT_APP_API_URL","data","error","console","handleFocus","handleBlur","window","addEventListener","removeEventListener","on","userId","status","emit","off","current","scrollIntoView","behavior","prev","setTimeout","filter","msg","read_at","sender_id","forEach","messageId","id","localStorage","getItem","senderId","handleTyping","clearTimeout","handleSend","trim","messageData","content","post","reactions","handleReaction","reaction","handleReply","message","document","querySelector","focus","display","justifyContent","alignItems","h","children","fileName","_jsxFileName","lineNumber","columnNumber","MessageBubble","_messages$find","_message$reactions","position","maxW","reply_to","borderLeftWidth","borderLeftColor","pl","mb","opacity","fontSize","find","m","bg","parseInt","color","borderRadius","px","py","length","spacing","mt","Object","entries","reduce","acc","r","map","count","variant","colorScheme","right","bottom","_groupHover","transition","placement","size","icon","w","p","cursor","_hover","onClick","label","flexDirection","borderBottom","borderColor","justify","align","fontWeight","flex","overflowY","alignSelf","ref","borderTop","value","onChange","e","target","placeholder","mr","wrap","gap","ml","_c","$RefreshReg$"],"sources":["C:/Users/sabin.arsene/Desktop/Tudu-app/TUDU/frontend/src/components/Chat/Chat.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { \r\n  Box, VStack, Input, Button, Text, Flex, HStack, \r\n  IconButton, Badge, Popover, PopoverTrigger, \r\n  PopoverContent, Tooltip, Spinner\r\n} from '@chakra-ui/react';\r\nimport { useSocket } from '../../contexts/SocketContext';\r\nimport axios from 'axios';\r\n\r\n// Corrected icon imports\r\nimport { Smile, CornerUpLeft } from 'react-feather';\r\n\r\nexport function Chat({ receiverId, receiverName }) {\r\n  const { socket } = useSocket();\r\n  const [messages, setMessages] = useState([]);\r\n  const [receiverStatus, setReceiverStatus] = useState('offline');\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [isWindowFocused, setIsWindowFocused] = useState(true);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [replyTo, setReplyTo] = useState(null);\r\n  \r\n  const messagesEndRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n\r\n  const loadMessages = async () => {\r\n    try {\r\n      const response = await axios.get(`${process.env.REACT_APP_API_URL}/messages/${receiverId}`);\r\n      setMessages(response.data);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error loading messages:', error);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleFocus = () => setIsWindowFocused(true);\r\n    const handleBlur = () => setIsWindowFocused(false);\r\n\r\n    window.addEventListener('focus', handleFocus);\r\n    window.addEventListener('blur', handleBlur);\r\n\r\n    // If you have a NotificationService, uncomment this\r\n    // NotificationService.requestPermission();\r\n\r\n    return () => {\r\n      window.removeEventListener('focus', handleFocus);\r\n      window.removeEventListener('blur', handleBlur);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadMessages();\r\n  }, [receiverId, loadMessages]);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('user_status', (data) => {\r\n        if (data.userId === receiverId) {\r\n          setReceiverStatus(data.status);\r\n        }\r\n      });\r\n\r\n      // Request receiver's status\r\n      socket.emit('get_user_status', receiverId);\r\n\r\n      return () => {\r\n        socket.off('user_status');\r\n      };\r\n    }\r\n  }, [socket, receiverId]);\r\n\r\n  // Scroll to bottom when messages change\r\n  useEffect(() => {\r\n    if (messagesEndRef.current) {\r\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.emit('join_chat', receiverId);\r\n      \r\n      socket.on('receive_message', (data) => {\r\n        setMessages(prev => [...prev, data]);\r\n        \r\n        if (!isWindowFocused) {\r\n          setUnreadCount(prev => prev + 1);\r\n          // If you have a NotificationService, uncomment this\r\n          // NotificationService.showNotification(`New message from ${receiverName}`, {\r\n          //   body: data.content,\r\n          //   tag: 'chat-message'\r\n          // }, {\r\n          //   once: true\r\n          // });\r\n        }\r\n      });\r\n\r\n      socket.on('user_typing', (userId) => {\r\n        if (userId === receiverId) {\r\n          setIsTyping(true);\r\n          setTimeout(() => setIsTyping(false), 3000);\r\n        }\r\n      });\r\n\r\n      return () => {\r\n        socket.off('receive_message');\r\n        socket.off('user_typing');\r\n        socket.emit('leave_chat', receiverId);\r\n      };\r\n    }\r\n  }, [socket, receiverId, isWindowFocused, receiverName]);\r\n\r\n  useEffect(() => {\r\n    if (isWindowFocused && unreadCount > 0) {\r\n      setUnreadCount(0);\r\n      // Mark messages as read\r\n      messages\r\n        .filter(msg => !msg.read_at && msg.sender_id === receiverId)\r\n        .forEach(msg => {\r\n          if (socket) {\r\n            socket.emit('message_read', {\r\n              messageId: msg.id,\r\n              userId: localStorage.getItem('userId'),\r\n              senderId: msg.sender_id\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }, [isWindowFocused, messages, unreadCount, receiverId, socket]);\r\n\r\n  const handleTyping = () => {\r\n    if (socket) {\r\n      socket.emit('typing', receiverId);\r\n    }\r\n\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n\r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      if (socket) {\r\n        socket.emit('stop_typing', receiverId);\r\n      }\r\n    }, 2000);\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if (!newMessage.trim()) return;\r\n\r\n    try {\r\n      const messageData = {\r\n        content: newMessage,\r\n        receiverId,\r\n        replyTo: replyTo?.id\r\n      };\r\n\r\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/messages`, messageData);\r\n      \r\n      if (socket) {\r\n        socket.emit('send_message', { ...response.data, receiverId });\r\n      }\r\n      \r\n      setMessages(prev => [...prev, response.data]);\r\n      setNewMessage('');\r\n      setReplyTo(null);\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n    }\r\n  };\r\n\r\n  const reactions = ['ðŸ‘', 'â¤ï¸', 'ðŸ˜Š', 'ðŸ˜‚', 'ðŸ˜®', 'ðŸ˜¢'];\r\n\r\n  const handleReaction = async (messageId, reaction) => {\r\n    try {\r\n      await axios.post(`${process.env.REACT_APP_API_URL}/messages/${messageId}/reactions`, {\r\n        reaction\r\n      });\r\n      \r\n      if (socket) {\r\n        socket.emit('message_reaction', { messageId, reaction, receiverId });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding reaction:', error);\r\n    }\r\n  };\r\n\r\n  const handleReply = (message) => {\r\n    setReplyTo(message);\r\n    // Focus on input\r\n    document.querySelector('#messageInput').focus();\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" h=\"100%\">\r\n        <Spinner />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  const MessageBubble = ({ message }) => (\r\n    <Box position=\"relative\" maxW=\"70%\">\r\n      {message.reply_to && (\r\n        <Box \r\n          borderLeftWidth=\"2px\" \r\n          borderLeftColor=\"gray.300\" \r\n          pl={2} \r\n          mb={1}\r\n          opacity={0.7}\r\n        >\r\n          <Text fontSize=\"sm\">{messages.find(m => m.id === message.reply_to)?.content}</Text>\r\n        </Box>\r\n      )}\r\n      <Box\r\n        bg={message.sender_id === parseInt(localStorage.getItem('userId')) ? 'blue.500' : 'gray.200'}\r\n        color={message.sender_id === parseInt(localStorage.getItem('userId')) ? 'white' : 'black'}\r\n        borderRadius=\"lg\"\r\n        px={3}\r\n        py={2}\r\n      >\r\n        <Text>{message.content}</Text>\r\n        {message.reactions?.length > 0 && (\r\n          <HStack spacing={1} mt={1}>\r\n            {Object.entries(\r\n              message.reactions.reduce((acc, r) => ({\r\n                ...acc,\r\n                [r.reaction]: (acc[r.reaction] || 0) + 1\r\n              }), {})\r\n            ).map(([reaction, count]) => (\r\n              <Badge key={reaction} variant=\"subtle\" colorScheme=\"gray\">\r\n                {reaction} {count}\r\n              </Badge>\r\n            ))}\r\n          </HStack>\r\n        )}\r\n      </Box>\r\n      <HStack position=\"absolute\" right={2} bottom={-6} opacity={0} _groupHover={{ opacity: 1 }} transition=\"0.2s\">\r\n        <Popover placement=\"top\">\r\n          <PopoverTrigger>\r\n            <IconButton size=\"xs\" icon={<Smile />} variant=\"ghost\" />\r\n          </PopoverTrigger>\r\n          <PopoverContent w=\"auto\" p={2}>\r\n            <HStack>\r\n              {reactions.map(reaction => (\r\n                <Box\r\n                  key={reaction}\r\n                  cursor=\"pointer\"\r\n                  p={1}\r\n                  _hover={{ bg: 'gray.100' }}\r\n                  onClick={() => handleReaction(message.id, reaction)}\r\n                >\r\n                  {reaction}\r\n                </Box>\r\n              ))}\r\n            </HStack>\r\n          </PopoverContent>\r\n        </Popover>\r\n        <Tooltip label=\"Reply\">\r\n          <IconButton \r\n            size=\"xs\" \r\n            icon={<CornerUpLeft />} \r\n            variant=\"ghost\"\r\n            onClick={() => handleReply(message)}\r\n          />\r\n        </Tooltip>\r\n      </HStack>\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <Box h=\"100%\" display=\"flex\" flexDirection=\"column\">\r\n      <Box p={4} bg=\"gray.100\" borderBottom=\"1px\" borderColor=\"gray.200\">\r\n        <Flex justify=\"space-between\" align=\"center\">\r\n          <Text fontWeight=\"bold\">{receiverName}</Text>\r\n          <Badge colorScheme={receiverStatus === 'online' ? 'green' : 'gray'}>\r\n            {receiverStatus}\r\n          </Badge>\r\n        </Flex>\r\n      </Box>\r\n\r\n      <VStack flex={1} p={4} spacing={4} overflowY=\"auto\">\r\n        {messages.map((message) => (\r\n          <MessageBubble key={message.id} message={message} />\r\n        ))}\r\n        {isTyping && (\r\n          <Text color=\"gray.500\" fontSize=\"sm\" alignSelf=\"flex-start\">\r\n            {receiverName} is typing...\r\n          </Text>\r\n        )}\r\n        <div ref={messagesEndRef} />\r\n      </VStack>\r\n\r\n      {replyTo && (\r\n        <Box p={2} bg=\"gray.50\" borderTop=\"1px\" borderColor=\"gray.200\">\r\n          <Flex justify=\"space-between\" align=\"center\">\r\n            <Text fontSize=\"sm\" color=\"gray.600\">Replying to: {replyTo.content}</Text>\r\n            <IconButton\r\n              icon={<CornerUpLeft size={16} />}\r\n              size=\"sm\"\r\n              variant=\"ghost\"\r\n              onClick={() => setReplyTo(null)}\r\n            />\r\n          </Flex>\r\n        </Box>\r\n      )}\r\n\r\n      <Box p={4} borderTop=\"1px\" borderColor=\"gray.200\">\r\n        <Flex>\r\n          <Input\r\n            id=\"messageInput\"\r\n            value={newMessage}\r\n            onChange={(e) => {\r\n              setNewMessage(e.target.value);\r\n              handleTyping();\r\n            }}\r\n            placeholder=\"Type a message...\"\r\n            mr={2}\r\n          />\r\n          <Popover>\r\n            <PopoverTrigger>\r\n              <IconButton icon={<Smile size={20} />} variant=\"ghost\" />\r\n            </PopoverTrigger>\r\n            <PopoverContent p={2}>\r\n              <Flex wrap=\"wrap\" gap={2}>\r\n                {reactions.map((reaction) => (\r\n                  <Button\r\n                    key={reaction}\r\n                    size=\"sm\"\r\n                    variant=\"ghost\"\r\n                    onClick={() => {\r\n                      setNewMessage(prev => prev + reaction);\r\n                      document.querySelector('#messageInput').focus();\r\n                    }}\r\n                  >\r\n                    {reaction}\r\n                  </Button>\r\n                ))}\r\n              </Flex>\r\n            </PopoverContent>\r\n          </Popover>\r\n          <Button ml={2} colorScheme=\"blue\" onClick={handleSend}>\r\n            Send\r\n          </Button>\r\n        </Flex>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}